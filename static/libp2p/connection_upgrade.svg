<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="594px" preserveAspectRatio="none" style="width:872px;height:594px;" version="1.1" viewBox="0 0 872 594" width="872px" zoomAndPan="magnify"><defs><filter height="300%" id="f12me8inqpyy8s" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2.0"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="4.0" dy="4.0" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><line style="stroke: #A80036; stroke-width: 1.0;" x1="346" x2="346" y1="51.4883" y2="363.9727"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 1.0,4.0;" x1="346" x2="346" y1="363.9727" y2="404.9277"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="346" x2="346" y1="404.9277" y2="536.8594"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="492" x2="492" y1="51.4883" y2="363.9727"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 1.0,4.0;" x1="492" x2="492" y1="363.9727" y2="404.9277"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="492" x2="492" y1="404.9277" y2="536.8594"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="54" x="316" y="48.5352">Initiator</text><ellipse cx="346" cy="19" fill="#FEFECE" filter="url(#f12me8inqpyy8s)" rx="12" ry="12" style="stroke: #A80036; stroke-width: 2.0;"/><line style="stroke: #A80036; stroke-width: 2.0;" x1="334" x2="358" y1="33" y2="33"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="54" x="316" y="549.3945">Initiator</text><ellipse cx="346" cy="568.3477" fill="#FEFECE" filter="url(#f12me8inqpyy8s)" rx="12" ry="12" style="stroke: #A80036; stroke-width: 2.0;"/><line style="stroke: #A80036; stroke-width: 2.0;" x1="334" x2="358" y1="582.3477" y2="582.3477"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="74" x="452" y="48.5352">Responder</text><ellipse cx="492" cy="19" fill="#FEFECE" filter="url(#f12me8inqpyy8s)" rx="12" ry="12" style="stroke: #A80036; stroke-width: 2.0;"/><line style="stroke: #A80036; stroke-width: 2.0;" x1="480" x2="504" y1="33" y2="33"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="74" x="452" y="549.3945">Responder</text><ellipse cx="492" cy="568.3477" fill="#FEFECE" filter="url(#f12me8inqpyy8s)" rx="12" ry="12" style="stroke: #A80036; stroke-width: 2.0;"/><line style="stroke: #A80036; stroke-width: 2.0;" x1="480" x2="504" y1="582.3477" y2="582.3477"/><rect fill="#EEEEEE" filter="url(#f12me8inqpyy8s)" height="3" style="stroke: #EEEEEE; stroke-width: 1.0;" width="857" x="3" y="82.1436"/><line style="stroke: #000000; stroke-width: 1.0;" x1="3" x2="860" y1="82.1436" y2="82.1436"/><line style="stroke: #000000; stroke-width: 1.0;" x1="3" x2="860" y1="85.1436" y2="85.1436"/><rect fill="#EEEEEE" filter="url(#f12me8inqpyy8s)" height="23.3105" style="stroke: #000000; stroke-width: 2.0;" width="221" x="321" y="71.4883"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="203" x="327" y="88.0566">Initial multistream handshake</text><polygon fill="#A80036" points="357,122.1094,347,126.1094,357,130.1094,353,126.1094" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="351" x2="491" y1="126.1094" y2="126.1094"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="122" x="363" y="121.3672">/multistream/1.0.0</text><polygon fill="#A80036" points="480,151.4199,490,155.4199,480,159.4199,484,155.4199" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="346" x2="486" y1="155.4199" y2="155.4199"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="122" x="353" y="150.6777">/multistream/1.0.0</text><rect fill="#EEEEEE" filter="url(#f12me8inqpyy8s)" height="3" style="stroke: #EEEEEE; stroke-width: 1.0;" width="857" x="3" y="184.0752"/><line style="stroke: #000000; stroke-width: 1.0;" x1="3" x2="860" y1="184.0752" y2="184.0752"/><line style="stroke: #000000; stroke-width: 1.0;" x1="3" x2="860" y1="187.0752" y2="187.0752"/><rect fill="#EEEEEE" filter="url(#f12me8inqpyy8s)" height="23.3105" style="stroke: #000000; stroke-width: 2.0;" width="200" x="331.5" y="173.4199"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="182" x="337.5" y="189.9883">Negotiate security protocol</text><polygon fill="#A80036" points="480,229.041,490,233.041,480,237.041,484,233.041" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="346" x2="486" y1="233.041" y2="233.041"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="62" x="353" y="228.2988">/tls/1.0.0</text><path d="M102,211.7305 L102,236.7305 L337,236.7305 L337,221.7305 L327,211.7305 L102,211.7305 " fill="#FBFB77" filter="url(#f12me8inqpyy8s)" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M327,211.7305 L327,221.7305 L337,221.7305 L327,211.7305 " fill="#FBFB77" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="214" x="108" y="229.2988">Initiator proposes TLS for security</text><polygon fill="#A80036" points="357,268.3516,347,272.3516,357,276.3516,353,272.3516" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="351" x2="491" y1="272.3516" y2="272.3516"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="15" x="363" y="267.6094">na</text><path d="M497,251.041 L497,276.041 L745,276.041 L745,261.041 L735,251.041 L497,251.041 " fill="#FBFB77" filter="url(#f12me8inqpyy8s)" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M735,251.041 L735,261.041 L745,261.041 L735,251.041 " fill="#FBFB77" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="227" x="503" y="268.6094">Responder does not support TLS yet</text><polygon fill="#A80036" points="480,307.6621,490,311.6621,480,315.6621,484,311.6621" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="346" x2="486" y1="311.6621" y2="311.6621"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="79" x="353" y="306.9199">/secio/1.0.0</text><path d="M143,290.3516 L143,315.3516 L337,315.3516 L337,300.3516 L327,290.3516 L143,290.3516 " fill="#FBFB77" filter="url(#f12me8inqpyy8s)" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M327,290.3516 L327,300.3516 L337,300.3516 L327,290.3516 " fill="#FBFB77" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="173" x="149" y="307.9199">Initiator falls back to SECIO</text><polygon fill="#A80036" points="357,346.9727,347,350.9727,357,354.9727,353,350.9727" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="351" x2="491" y1="350.9727" y2="350.9727"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="79" x="363" y="346.2305">/secio/1.0.0</text><path d="M497,329.6621 L497,354.6621 L844,354.6621 L844,339.6621 L834,329.6621 L497,329.6621 " fill="#FBFB77" filter="url(#f12me8inqpyy8s)" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M834,329.6621 L834,339.6621 L844,339.6621 L834,329.6621 " fill="#FBFB77" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="326" x="503" y="347.2305">Responder supports SECIO, echoes back protocol id</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="93" x="372.5" y="388.6074">SECIO handshake</text><rect fill="#EEEEEE" filter="url(#f12me8inqpyy8s)" height="3" style="stroke: #EEEEEE; stroke-width: 1.0;" width="857" x="3" y="425.583"/><line style="stroke: #000000; stroke-width: 1.0;" x1="3" x2="860" y1="425.583" y2="425.583"/><line style="stroke: #000000; stroke-width: 1.0;" x1="3" x2="860" y1="428.583" y2="428.583"/><rect fill="#EEEEEE" filter="url(#f12me8inqpyy8s)" height="23.3105" style="stroke: #000000; stroke-width: 2.0;" width="216" x="323.5" y="414.9277"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="198" x="329.5" y="431.4961">Negotiate stream multiplexer</text><polygon fill="#A80036" points="480,470.5488,490,474.5488,480,478.5488,484,474.5488" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="346" x2="486" y1="474.5488" y2="474.5488"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="85" x="353" y="469.8066">/mplex/1.0.0</text><path d="M8,453.2383 L8,478.2383 L337,478.2383 L337,463.2383 L327,453.2383 L8,453.2383 " fill="#FBFB77" filter="url(#f12me8inqpyy8s)" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M327,453.2383 L327,463.2383 L337,463.2383 L327,453.2383 " fill="#FBFB77" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="308" x="14" y="470.8066">Initiator proposes mplex for stream multiplexing</text><polygon fill="#A80036" points="357,509.8594,347,513.8594,357,517.8594,353,513.8594" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="351" x2="491" y1="513.8594" y2="513.8594"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="85" x="363" y="509.1172">/mplex/1.0.0</text><path d="M497,492.5488 L497,517.5488 L846,517.5488 L846,502.5488 L836,492.5488 L497,492.5488 " fill="#FBFB77" filter="url(#f12me8inqpyy8s)" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M836,492.5488 L836,502.5488 L846,502.5488 L836,492.5488 " fill="#FBFB77" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="328" x="503" y="510.1172">Responder supports mplex, echoes back protocol id</text><!--
@startuml

entity Initiator
entity Responder

== Initial multistream handshake ==

Responder -> Initiator: /multistream/1.0.0
Initiator -> Responder: /multistream/1.0.0

== Negotiate security protocol ==

Initiator -> Responder: /tls/1.0.0
note left: Initiator proposes TLS for security

Responder -> Initiator: na
note right: Responder does not support TLS yet

Initiator -> Responder: /secio/1.0.0
note left: Initiator falls back to SECIO

Responder -> Initiator: /secio/1.0.0
note right: Responder supports SECIO, echoes back protocol id

... SECIO handshake ...

== Negotiate stream multiplexer ==

Initiator -> Responder: /mplex/1.0.0
note left: Initiator proposes mplex for stream multiplexing

Responder -> Initiator: /mplex/1.0.0
note right: Responder supports mplex, echoes back protocol id


@enduml

PlantUML version 1.2019.05(Sat Apr 20 12:45:36 EDT 2019)
(GPL source distribution)
Java Runtime: Java(TM) SE Runtime Environment
JVM: Java HotSpot(TM) 64-Bit Server VM
Java Version: 1.8.0_201-b09
Operating System: Mac OS X
OS Version: 10.14.4
Default Encoding: UTF-8
Language: en
Country: US
--></g></svg>